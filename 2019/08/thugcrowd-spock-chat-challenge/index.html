<!DOCTYPE html>
<html lang="en">
<head>
	<!-- Basic Metas -->
	<meta charset="utf-8">
	<title>ThugCrowd Spock Chat Challenge | shambo.li</title>
	<meta name="description" content="Thugcrowd Matrix Spock Challenge, Mirror: Yet again, we have another classic ThugCrowd chat challenge, this time, featuring a picture of Spock from Star Trek. This challenge was set to expire in 14 days from the publishing date, but unfortunately the steps to …">
	<meta name="author" content="n">
	<link rel="author" href=""/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<!-- Twitter Cards and Open Graph -->
	<meta name="twitter:card" content="summary">
	<meta name="twitter:creator" content="@shamb0li">
	<meta name="twitter:domain" content="shambo.li">
	<meta name="twitter:site" content="@shamb0li">
	<meta property="og:title" content="ThugCrowd Spock Chat Challenge">
	<meta property="og:description" content="Thugcrowd Matrix Spock Challenge, Mirror: Yet again, we have another classic ThugCrowd chat challenge, this time, featuring a picture of Spock from Star Trek. This challenge was set to expire in 14 days from the publishing date, but unfortunately the steps to …">
	<meta property="og:image" content="../../../images/icons/avatar.png">
	<meta property="og:type" content="article">
	<meta property="og:url" content="../../../2019/08/thugcrowd-spock-chat-challenge/">

	<!-- Stylesheets and Web Fonts -->
	<link href="/theme/style.min.css?2af86252" rel="stylesheet">
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-1.x-git.min.js"></script>
    <script src="/includes/js/lightbox.js"></script>
    <link href="/includes/css/lightbox.css" rel="stylesheet" />

	<!-- Favicons -->
	<link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="57x57" href="/images/icons/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/images/icons/apple-touch-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/images/icons/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/images/icons/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/images/icons/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/images/icons/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/images/icons/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/images/icons/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/images/icons/apple-touch-icon-180x180.png">

	<link rel="icon" type="image/png" href="/images/icons/favicon-16x16.png" sizes="16x16">
	<link rel="icon" type="image/png" href="/images/icons/favicon-32x32.png" sizes="32x32">
	<link rel="icon" type="image/png" href="/images/icons/favicon-96x96.png" sizes="96x96">
	<link rel="icon" type="image/png" href="/images/icons/favicon-160x160.png" sizes="160x160">
	<link rel="icon" type="image/png" href="/images/icons/favicon-196x196.png" sizes="196x196">

	<meta name="theme-color" content="">

	<meta name="msapplication-TileColor" content="">
	<meta name="msapplication-TileImage" content="/images/icons/mstile-144x144.png">
	<meta name="msapplication-square70x70logo" content="/images/icons/mstile-small.png">
	<meta name="msapplication-square150x150logo" content="/images/icons/mstile-medium.png">
	<meta name="msapplication-wide310x150logo" content="/images/icons/mstile-wide.png">
	<meta name="msapplication-square310x310logo" content="/images/icons/mstile-large.png">

	<!--[if lt IE 9]>
	<script src="/theme/js/html5shiv.min.js"></script>
	<script src="/theme/js/respond.min.js"></script>
	<![endif]-->
</head>

<body>
	<div class="container">
		<aside>
			<a href="/"><img id="avatar" alt="Site Avatar" src="/images/icons/avatar.png"></a>
			<div id="name"><a href="/">shambo.li</a></div>
			<div id="bio">just a person who does some things online<hr>
occasionally posts writeups, occasionally participates in ctfs, occasionally plays video games
</div>

			<div id="sidebar-links">
				<a href="/about-me/">About</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="/archive/">Archive</a>
			</div>

			<div id="social">
				<a href="mailto:n@shambo.li" title="send me an email" class="icon fa fa-envelope-o"></a>
				<a href="http://twitter.com/shamb0li" title="follow me on twitter" class="icon fa fa-twitter"></a>
				<a href="http://github.com/shamboli" title="shamboli github" class="icon fa fa-github"></a>
			</div>

			<hr id="sidebar-divider">
		</aside>

		<article>
	<h1 class="title"><a href="/2019/08/thugcrowd-spock-chat-challenge/" title="Permalink to ThugCrowd Spock Chat Challenge">ThugCrowd Spock Chat&nbsp;Challenge</a></h1>
	<time class="date" datetime="2019-08-10 12:00:00-05:00">Sat 10 August 2019</time>
	<div class="content">
		<h2><a href="https://twitter.com/thugcrowd/status/1158172622577946625">Thugcrowd Matrix Spock Challenge</a>, <a href="http://archive.is/kldUo">Mirror</a>:</h2>
<p>Yet again, we have another classic ThugCrowd chat challenge, this time, featuring a picture of Spock from Star Trek. This challenge was set to expire in 14 days from the publishing date, but unfortunately the steps to solve it were leaked early which is why I&#8217;m publishing this writeup early as well. To begin, the tweet contains the following&nbsp;message: </p>
<div class="codehilite"><pre><span></span><span class="gd">--- BEGIN ThugCrowd Chat Challenge No. 4 ---</span>

This message will self destruct in 14 days

YmVnaW4gNjY0IHVybApNOicxVDwnLForUl1UPEYlTjxWOUU8QllTOiJdLDFXLFc4Ml1TPSYlUjlGUUU5NzE/PSY1Ujs2RU44NlAqCmAKZW5kCg==
</pre></div>


<p>This string appears to have a main characteristic of a base64 encoded string (the padding on the end), so we can throw this into a <a href="https://cryptii.com/pipes/base64-to-text">base64 decode utility</a>, or just use bash. Either way, we can decode it into&nbsp;this: </p>
<div class="codehilite"><pre><span></span><span class="nt">begin</span> <span class="nt">664</span> <span class="nt">url</span>
<span class="nt">M</span><span class="o">:</span><span class="s1">&#39;1T&lt;&#39;</span><span class="o">,</span><span class="nt">Z</span><span class="o">+</span><span class="nt">R</span><span class="o">]</span><span class="nt">T</span><span class="o">&lt;</span><span class="nt">F</span><span class="o">%</span><span class="nt">N</span><span class="o">&lt;</span><span class="nt">V9E</span><span class="o">&lt;</span><span class="nt">BYS</span><span class="o">:</span><span class="err">&quot;</span><span class="o">],</span><span class="nt">1W</span><span class="o">,</span><span class="nt">W82</span><span class="o">]</span><span class="nt">S</span><span class="o">=&amp;%</span><span class="nt">R9FQE971</span><span class="o">?=&amp;</span><span class="nt">5R</span><span class="o">;</span><span class="nt">6EN86P</span><span class="o">*</span>
<span class="err">`</span>
<span class="nt">end</span>
</pre></div>


<p>I was unfamiliar with this syntax, so I searched for <code>begin 664 url</code>, which turned out to be a <a href="https://en.wikipedia.org/wiki/Uuencoding">Uuencoded</a> package. To turn this file into something worthwhile, we can use <code>uudecode</code> in Linux to decode and unpack. Decoding provides us with a text file, and getting the&nbsp;contents: </p>
<div class="codehilite"><pre><span></span>user@box:~/tc_spock_chat$ cat url 
https://transfer.sh/LGs7a/starfleet_terminal
</pre></div>


<p>Downloading the file and performing some basic identification&nbsp;analysis: </p>
<div class="codehilite"><pre><span></span>user@box:~/tc_spock_chat$ file starfleet_terminal 
starfleet_terminal: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), for GNU/Linux 3.2.0, BuildID[sha1]=17f312b0279669021ac1fd51f1aa39c42a773bad, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, no section header


user@box:~/tc_spock_chat$ binwalk starfleet_terminal 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             ELF, 64-bit LSB shared object, AMD x86-64, version 1 (SYSV)
544           0x220           LZMA compressed data, properties: 0x5C, dictionary size: 0 bytes, uncompressed size: 1543503872 bytes
552           0x228           LZMA compressed data, properties: 0x5C, dictionary size: 0 bytes, uncompressed size: 67108864 bytes
13476         0x34A4          LZMA compressed data, properties: 0x5C, dictionary size: -1056964608 bytes, uncompressed size: 436207580 bytes
13568         0x3500          LZMA compressed data, properties: 0xB8, dictionary size: -1023410176 bytes, uncompressed size: 1442840540 bytes
16160         0x3F20          LZMA compressed data, properties: 0xC0, dictionary size: 0 bytes, uncompressed size: 150994944 bytes
</pre></div>


<p>Based on this initial inspection, it&#8217;s safe to say that this is an executable file, and since I&#8217;m running this challenge in a decently secured sandbox, I don&#8217;t have any qualms about executing the binary in bash, but you could also run it in <code>gdb</code> if you wanted to step through it. I didn&#8217;t feel like this was necessary, so I <code>chmod +x starfleet_terminal</code> and executed it. One of the interesting things about this binary, is that it floods the screen with newlines, and accepts all input, but doesn&#8217;t respond in any way until you try to kill the program with <code>CTRL-C</code>. I ended up with something like&nbsp;this: </p>
<div class="codehilite"><pre><span></span>user@box:~/tc_spock_chat$ ./starfleet_terminal 
ENTERPRISE TERMINAL:

&lt;snip whitespace&gt;

^C

ESTABLISHING SIGNAL...


ESTABLISHING SIGNAL...


ESTABLISHING SIGNAL...


ESTABLISHING SIGNAL...


ESTABLISHING SIGNAL...
CONNECTION ESTABLISHED
...
 ... INCOMING EMERGENCY BROADCAST
 ...
 ...
 ... ACCEPTING BROADCAST MESSAGE
 ... 




                                        .                                        
                                       .:.                                       
                                      .:::.                                      
                                     .:::::.                                     
                                 ***.:::::::.***                                 
                            *******.:::::::::.*******                            
                          ********.:::::::::::.********                          
                         ********.:::::::::::::.********                         
                         *******.::::::&#39;***`::::.*******                         
                         ******.::::&#39;*********`::.******                         
                          ****.:::&#39;*************`:.****                          
                            *.::&#39;*****************`.*                            
                            .:&#39;  ***************    .                            
                           .                                                     


   ##############################################################################
   ##############################################################################
   ##########################        BROADCAST       ############################
   ##############################################################################
   ##############################################################################
   #**********************************ORIGIN************************************#
   #                                                                            #
   #                              STARFLEET SHIP                                #
   #----------------------------------------------------------------------------#
   #                                                                            #
   #                              USS VENGEANCE                                 #
   #                                                                            #
   #****************************************************************************#
   #                                                                            #
   #                               REGISTRY ID                                  #
   #----------------------------------------------------------------------------#
   #                                                                            #
   #                               NCC-177358                                   #
   #                                                                            #
   #*********************************MESSAGE************************************#
   # MAYDAY                                                                     #
   #                                                                            #
   # MAYDAY                                                                     #
   #                                                                            #
   # WE HAVE BEEN BOARDED BY KAHN, HE IS COMMANDEERING THE SHIP.                #
   #                                                                            #
   # HE HAS KILLED ADMIRAL MARCUS                                               #
   #                                                                            #
   # HE IS NOW TRANSPORTING SEVENTY TWO ADVANCED LONG-RANGE TORPEDOES           #
   #                                                                            #
   # WE BELIEVE HE IS AIMING FOR STARFLEET HEADQUATERS                          #
   #                                                                            #
   # THE ENTERPRISE IS HEAVILY DAMAGED                                          #
   #                                                                            #
   #**********************************ERROR*************************************#

   SIGNAL LOST ....
   ...
   ATTEMTPING TO REESTABLISH  ...........
   .......
   ............
   .............
   UNABLE TO ESTABLISH CONNECTION ............. 
   ....
   ARCHIVING MESSAGE.. 
   .........
   .............. 
   ARCHIVED MESSAGE : 

     /Td6WFoAAATm1rRGAgAhARYAAAB0L+WjAQCeH4sICMA2Rl0AA2N0NjQAHcvRCoIwFADQd79GW0E9 
     NsF5lw1MnfO+6RYzu6tAMvz7qPdz6qAZ5JI6JpPelDPkjgahlqFtvBN7r8WYYIwztjoubrzp24RA 
     UABxCJBfnlhxskzREBRFRcpXNHyxj/Kf3WYkG/TLsh/cTb3IYhDZG1M+dUau14ovzpS+ZvKOBvx5 
     On5UtT1FXxDiLoKWAAAAAABY3YwVRBDWWgABtwGfAQAAZUUbHbHEZ/sCAAAAAARZWg== 

ENTERPRISE TERMINAL:
</pre></div>


<p>In this awesome looking output, we have an archived message near the bottom, which again appears to be base64 encoded, so we can decode it and see what type of file it&nbsp;is:</p>
<div class="codehilite"><pre><span></span>user@box:~/tc_spock_chat$ base64 -d &lt;&lt;&lt; /Td6WFoAAATm1rRGAgAhARYAAAB0L+WjAQCeH4sICMA2Rl0AA2N0NjQAHcvRCoIwFADQd79GW0E9NsF5lw1MnfO+6RYzu6tAMvz7qPdz6qAZ5JI6JpPelDPkjgahlqFtvBN7r8WYYIwztjoubrzp24RAUABxCJBfnlhxskzREBRFRcpXNHyxj/Kf3WYkG/TLsh/cTb3IYhDZG1M+dUau14ovzpS+ZvKOBvx5On5UtT1FXxDiLoKWAAAAAABY3YwVRBDWWgABtwGfAQAAZUUbHbHEZ/sCAAAAAARZWg==&gt;archived_message.file

user@box:~/tc_spock_chat$ file archived_message.file
archived_message: XZ compressed data
</pre></div>


<p>I wasn&#8217;t familiar with <code>.xz</code> compression beforehand, so I kept going with basic&nbsp;analysis: </p>
<div class="codehilite"><pre><span></span>user@box:~/tc_spock_chat$ binwalk archived_message.file

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             xz compressed data
27            0x1B            gzip compressed data, has original file name: &quot;ct64&quot;, from Unix, last modified: 2019-08-04 01:37:04
</pre></div>


<p>And the <code>gzip</code> really gave it away (I suppose <code>compressed data</code> wasn&#8217;t obvious enough for me). We can use <code>unxz</code> to unpack the&nbsp;binary: </p>
<div class="codehilite"><pre><span></span>user@box:~/tc_spock_chat$ unxz archived_message.file 
unxz: archived_message.file: Filename has an unknown suffix, skipping
</pre></div>


<p>Rename the file to .xz and try&nbsp;again&#8230;</p>
<div class="codehilite"><pre><span></span>user@box:~/tc_spock_chat$ mv archived_message.file archived_message.xz
user@box:~/tc_spock_chat$ unxz archived_message.xz
</pre></div>


<p>This expands the <code>gzip</code> file, which we can extract with&nbsp;gunzip: </p>
<div class="codehilite"><pre><span></span>user@box:~/tc_spock_chat$ gunzip archived_message 
gzip: archived_message: unknown suffix -- ignored
</pre></div>


<p>And the filetype&nbsp;again&#8230;</p>
<div class="codehilite"><pre><span></span>user@box:~/tc_spock_chat$ mv archived_message  archived_message.gz
user@box:~/tc_spock_chat$ gunzip archived_message.gz 
</pre></div>


<p>And now we&#8217;re left with another text file with a&nbsp;string:</p>
<div class="codehilite"><pre><span></span>user@box:~/tc_spock_chat$ cat archived_message 
TmV3IHJlY3J1aXQsIHdlbGNvbWUgdG8gVGh1Z0ZsZWV0LiBUaW1lIGlmIG9mIHRoZSBlc3NlbmNl
LCByZXBvcnQgdG8gd2hlcmVpc3RoZS5jaGF0IGFuZCBjYXJyeSBvdXQgT3JkZXIgMjAwNS4K
</pre></div>


<p>Again, this looks like&nbsp;base64:</p>
<div class="codehilite"><pre><span></span>user@box:~/tc_spock_chat$ base64 -d archived_message
New recruit, welcome to ThugFleet. Time if of the essence, report to whereisthe.chat and carry out Order 2005.
</pre></div>


<p>Unfortunately, due to the challenge being leaked, <code>whereisthe.chat</code> now redirects to the main ThugCrowd website, so I&#8217;ll have to omit some graphics regarding the next section. Visiting <code>whereisthe.chat</code>, the user is given a <span class="caps">QR</span> code which can be decoded with a number of different utilities. I chose <code>zbarimg</code>, which can decode an input <span class="caps">QR</span> code to the plaintext&nbsp;result:</p>
<div class="codehilite"><pre><span></span>user@box:~/tc_spock_chat$ zbarimg whereisthe.chat.png 
QR-Code:otpauth://totp/StarThug:you@thu.gg?issuer=OperationSelfDestruct&amp;algorithm=SHA1&amp;digits=6&amp;period=30&amp;secret=GE4TELRRGY4C4MJSFY4TSLRT&amp;port=42069
scanned 1 barcode symbols from 1 images in 0.03 seconds
</pre></div>


<p>This result immediately looks like a time-based one-time password, indicated by <code>otpauth</code>, <code>totp</code>, <code>digits</code>, <code>period</code> - you can read more about this on the <a href="https://github.com/google/google-authenticator/wiki/Key-Uri-Format">Google Authenticator Key <span class="caps">URI</span> Format</a> GitHub page. The interesting things about this <code>otpauth</code> url are the port on the end, <code>42069</code>, and the <code>secret</code>, which as seen in the GitHub page, is a base32 encoded key, with no padding required (the padding in this case was an arbitrary number appended to the requester&#8217;s <span class="caps">IP</span>&nbsp;address): </p>
<div class="codehilite"><pre><span></span>user@box:~/tc_spock_chat$ base32 -d &lt;&lt;&lt; GE4TELRRGY4C4MJSFY4TSLRT
192.168.12.99.3
</pre></div>


<p>There doesn&#8217;t seem to be anything fishy with this, so I loaded the <span class="caps">QR</span> code into <a href="https://winauth.github.io/winauth/">WinAuth</a> to generate my <span class="caps">OTP</span>. The more pressing matter however is the port at the end of the <code>otpauth</code> string, and to which host it&#8217;s used to connect. We probably don&#8217;t have that port open on our own machine (unless the archived message opened it, but it didn&#8217;t), so I tried to connect to the <span class="caps">QR</span> code issuing website, since that&#8217;s the only other server we&#8217;ve been given so&nbsp;far: </p>
<div class="codehilite"><pre><span></span>user@box:~/tc_spock_chat$ nc whereisthe.chat 42069
DESTRUCT SEQUENCE
    ONE      
  CODE:768290
ABORTING
DESTRUCT SEQUENCE
    ONE      
  CODE:768 290 
ABORTING
DESTRUCT SEQUENCE
    ONE      
  CODE:803 923
ABORTING
DESTRUCT SEQUENCE
    ONE      
  CODE:803923
ABORTING
</pre></div>


<p>As seen above, I tried entering my <span class="caps">OTP</span> code a few different ways, but I couldn&#8217;t get the destruct sequence to start. A little bit of searching on Memory Alpha turned up <a href="https://memory-alpha.fandom.com/wiki/Auto-destruct">a page about Order 2005</a>. Unfortunately I skipped <span class="caps">TOS</span> and went straight into <span class="caps">TNG</span>/Voyager&#8230; Anyway, let&#8217;s give this a shot (still keeping our <span class="caps">OTP</span> code in&nbsp;mind): </p>
<div class="codehilite"><pre><span></span>user@box:~/tc_spock_chat$ nc whereisthe.chat 42069


DESTRUCT SEQUENCE
    ONE      
  CODE:11A
DESTRUCT SEQUENCE
    TWO      
  CODE:11A2B
DESTRUCT SEQUENCE
   THREE    
  CODE:1B2B3


DESTRUCT SEQUENCE
 COMPLETED    
   AND ENGAGED   


  AWAITING     
 FINAL CODE    
  FOR 30-SECOND   
    COUNTDOWN    

  CODE:724137
ENCRYPTED MESSAGE FROM THUGFLEET
               .
              .:.
             .:::.
            .:::::.
        ***.:::::::.***
   *******.:::::::::.*******
 ********.:::::::::::.********
********.:::::::::::::.********
*******.::::::&#39;***`::::.*******
******.::::&#39;*********`::.******
 ****.:::&#39;*************`:.****
   *.::&#39;*****************`.*
   .:&#39;  ***************    .
  .
jrKJt72MnauFjJ3uvJydi4bt5u+7l7S3lpmzqbuMnaW97afthYiOuLuYt7OWl53uurGvrIWMmriN7ee4u5jnuLyys6m7nOqvvYyd772mnbW8som3u5iKuIaI67iGiJG1veyJqruc67iJmLezvbadrr3ts6qWnJG2veyVsZCyt6m7mKevvbKKqoayp6+9tuqxhaadt72yjri7l7OohYyet4aHie++nJ2qvO2vsoW0jbCLtKeQke67rJCKlqiJmo6mkIeds5CKjZC7ma+Ou++JkYqO4uI=
</pre></div>


<p>Now this looks like something we would expect, a Thugcrypted message from ThugFleet. Again, this appears to be a base64 encoded string, so let&#8217;s do some basic&nbsp;checking: </p>
<div class="codehilite"><pre><span></span>user@box:~/tc_spock_chat$ base64 -d &lt;&lt;&lt; jrKJt72MnauFjJ3uvJydi4bt5u+7l7S3lpmzqbuMnaW97afthYiOuLuYt7OWl53uurGvrIWMmriN7ee4u5jnuLyys6m7nOqvvYyd772mnbW8som3u5iKuIaI67iGiJG1veyJqruc67iJmLezvbadrr3ts6qWnJG2veyVsZCyt6m7mKevvbKKqoayp6+9tuqxhaadt72yjri7l7OohYyet4aHie++nJ2qvO2vsoW0jbCLtKeQke67rJCKlqiJmo6mkIeds5CKjZC7ma+Ou++JkYqO4uI=
����������������ﻗ�������������텈�����������������縻�縼�����꯽��ｦ������������븆����쉪��븉����������������앱������������������걅������������������ﾜ����������������������������������������

user@box:~/tc_spock_chat$ base64 -d &lt;&lt;&lt; jrKJt72MnauFjJ3uvJydi4bt5u+7l7S3lpmzqbuMnaW97afthYiOuLuYt7OWl53uurGvrIWMmriN7ee4u5jnuLyys6m7nOqvvYyd772mnbW8som3u5iKuIaI67iGiJG1veyJqruc67iJmLezvbadrr3ts6qWnJG2veyVsZCyt6m7mKevvbKKqoayp6+9tuqxhaadt72yjri7l7OohYyet4aHie++nJ2qvO2vsoW0jbCLtKeQke67rJCKlqiJmo6mkIeds5CKjZC7ma+Ou++JkYqO4uI=&gt; encrypted_message

user@box:~/tc_spock_chat$ file encrypted_message 
encrypted_message: Non-ISO extended-ASCII text, with NEL line terminators

user@box:~/tc_spock_chat$ binwalk encrypted_message 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
</pre></div>


<p>Now is where the real fun begins. There are a few different methods to solve this, but the most important thing we need to do is to identify what type of file we are actually working with. Unbeknownst to me at the time, there exists a pretty cool tool called <a href="https://gchq.github.io/CyberChef">CyberChef</a> which trivializes this challenge, with the <code>magic</code> operator. If this is the tool you would decide to use, the proper way of going about this would be to use the following&nbsp;recipe: </p>
<div class="codehilite"><pre><span></span>Input = jrKJt72MnauFjJ3uvJydi4bt5u+7l7S3lpmzqbuMnaW97afthYiOuLuYt7OWl53uurGvrIWMmriN7ee4u5jnuLyys6m7nOqvvYyd772mnbW8som3u5iKuIaI67iGiJG1veyJqruc67iJmLezvbadrr3ts6qWnJG2veyVsZCyt6m7mKevvbKKqoayp6+9tuqxhaadt72yjri7l7OohYyet4aHie++nJ2qvO2vsoW0jbCLtKeQke67rJCKlqiJmo6mkIeds5CKjZC7ma+Ou++JkYqO4uI=

From Base64
&quot;Magic&quot; (scroll through until you find something that looks legitimate, and click on one of the results and finish from there)
</pre></div>


<p>This will give you an auth code and connection information to join the ThugCrowd Matrix chat. If you&#8217;re interested in another way to solve this, please continue&nbsp;reading. </p>
<hr>

<p>Speaking with one of my more savvy friends about this, I originally thought this was some type of private key or other type of secret which contained the answer - however, I wasn&#8217;t able to get anywhere by formatting it multiple ways and trying to use <code>openssl</code> to decode the message. The decoded base64 output didn&#8217;t really give me any major pointers, but one of the things he pointed out to me was that I should take a look at the bytes in the hex&nbsp;dump: </p>
<div class="codehilite"><pre><span></span>user@box:~/tc_spock_chat$ base64 -d &lt;&lt;&lt; jrKJt72MnauFjJ3uvJydi4bt5u+7l7S3lpmzqbuMnaW97afthYiOuLuYt7OWl53uurGvrIWMmriN7ee4u5jnuLyys6m7nOqvvYyd772mnbW8som3u5iKuIaI67iGiJG1veyJqruc67iJmLezvbadrr3ts6qWnJG2veyVsZCyt6m7mKevvbKKqoayp6+9tuqxhaadt72yjri7l7OohYyet4aHie++nJ2qvO2vsoW0jbCLtKeQke67rJCKlqiJmo6mkIeds5CKjZC7ma+Ou++JkYqO4uI= | xxd
00000000: 8eb2 89b7 bd8c 9dab 858c 9dee bc9c 9d8b  ................
00000010: 86ed e6ef bb97 b4b7 9699 b3a9 bb8c 9da5  ................
00000020: bded a7ed 8588 8eb8 bb98 b7b3 9697 9dee  ................
00000030: bab1 afac 858c 9ab8 8ded e7b8 bb98 e7b8  ................
00000040: bcb2 b3a9 bb9c eaaf bd8c 9def bda6 9db5  ................
00000050: bcb2 89b7 bb98 8ab8 8688 ebb8 8688 91b5  ................
00000060: bdec 89aa bb9c ebb8 8998 b7b3 bdb6 9dae  ................
00000070: bded b3aa 969c 91b6 bdec 95b1 90b2 b7a9  ................
00000080: bb98 a7af bdb2 8aaa 86b2 a7af bdb6 eab1  ................
00000090: 85a6 9db7 bdb2 8eb8 bb97 b3a8 858c 9eb7  ................
000000a0: 8687 89ef be9c 9daa bced afb2 85b4 8db0  ................
000000b0: 8bb4 a790 91ee bbac 908a 96a8 899a 8ea6  ................
000000c0: 9087 9db3 908a 8d90 bb99 af8e bbef 8991  ................
000000d0: 8a8e e2e2                                ....
</pre></div>


<p>He made the observation that the bytes were somewhat uniform, and that they were all just right outside of the printable <span class="caps">ASCII</span> hexadecimal range&nbsp;(0x20-0x7F): </p>
<div class="codehilite"><pre><span></span>  <span class="nt">2</span> <span class="nt">3</span> <span class="nt">4</span> <span class="nt">5</span> <span class="nt">6</span> <span class="nt">7</span>   
<span class="nt">-------------</span>  
<span class="nt">0</span><span class="o">:</span>   <span class="nt">0</span> <span class="o">@</span> <span class="nt">P</span> <span class="err">`</span> <span class="nt">p</span>   
<span class="nt">1</span><span class="o">:</span> <span class="o">!</span> <span class="nt">1</span> <span class="nt">A</span> <span class="nt">Q</span> <span class="nt">a</span> <span class="nt">q</span>  
<span class="nt">2</span><span class="o">:</span> <span class="err">&quot;</span> <span class="nt">2</span> <span class="nt">B</span> <span class="nt">R</span> <span class="nt">b</span> <span class="nt">r</span>  
<span class="nt">3</span><span class="o">:</span> <span class="err">#</span> <span class="nt">3</span> <span class="nt">C</span> <span class="nt">S</span> <span class="nt">c</span> <span class="nt">s</span>  
<span class="nt">4</span><span class="o">:</span> <span class="o">$</span> <span class="nt">4</span> <span class="nt">D</span> <span class="nt">T</span> <span class="nt">d</span> <span class="nt">t</span>
<span class="nt">5</span><span class="o">:</span> <span class="o">%</span> <span class="nt">5</span> <span class="nt">E</span> <span class="nt">U</span> <span class="nt">e</span> <span class="nt">u</span>  
<span class="nt">6</span><span class="o">:</span> <span class="o">&amp;</span> <span class="nt">6</span> <span class="nt">F</span> <span class="nt">V</span> <span class="nt">f</span> <span class="nt">v</span> 
<span class="nt">7</span><span class="o">:</span> <span class="err">&#39;</span> <span class="nt">7</span> <span class="nt">G</span> <span class="nt">W</span> <span class="nt">g</span> <span class="nt">w</span>  
<span class="nt">8</span><span class="o">:</span> <span class="o">(</span> <span class="nt">8</span> <span class="nt">H</span> <span class="nt">X</span> <span class="nt">h</span> <span class="nt">x</span> 
<span class="nt">9</span><span class="o">:</span> <span class="o">)</span> <span class="nt">9</span> <span class="nt">I</span> <span class="nt">Y</span> <span class="nt">i</span> <span class="nt">y</span>
<span class="nt">A</span><span class="o">:</span> <span class="o">*</span> <span class="o">:</span> <span class="nt">J</span> <span class="nt">Z</span> <span class="nt">j</span> <span class="nt">z</span>
<span class="nt">B</span><span class="o">:</span> <span class="o">+</span> <span class="o">;</span> <span class="nt">K</span> <span class="cp">[</span> <span class="nx">k</span> <span class="p">{</span>
<span class="nx">C</span><span class="p">:</span> <span class="p">,</span> <span class="o">&lt;</span> <span class="nx">L</span> <span class="o">\</span> <span class="nx">l</span> <span class="o">|</span>
<span class="nx">D</span><span class="p">:</span> <span class="o">-</span> <span class="o">=</span> <span class="nx">M</span> <span class="cp">]</span> <span class="nt">m</span> <span class="err">}</span>
<span class="nt">E</span><span class="o">:</span> <span class="o">.</span> <span class="o">&gt;</span> <span class="nt">N</span> <span class="o">^</span> <span class="nt">n</span> <span class="o">~</span>
<span class="nt">F</span><span class="o">:</span> <span class="o">/</span> <span class="o">?</span> <span class="nt">O</span> <span class="nt">_</span> <span class="nt">o</span> <span class="nt">DEL</span>
</pre></div>


<p>I didn&#8217;t notice this at the time, and I probably wouldn&#8217;t have been able to figure this out without that tip, but I like to believe the ThugCrowd challenges are all about spreading knowledge and helping everyone to improve. I decided this one might be a bit much to finish in Microsoft Excel, so I started looking up some more command-line ways of processing <span class="caps">XOR</span>&#8217;d strings. I had previously used <a href="https://github.com/hellman/xortool">xortool</a>, but I don&#8217;t think it&#8217;s the best method to use if you&#8217;re looking to understand the solution, so I kept searching, and eventually found a set of crypto challenges on <a href="https://cryptopals.com/sets/1">cryptopals</a> which helped me write my own tool to decode this&nbsp;message.</p>
<p>I worked through the first few challenges to get an idea as to how I was going to approach <a href="https://cryptopals.com/sets/1/challenges/3">challenge 3</a>, and the code below was what I wrote to decode this message (it expands upon the Cryptopals challenge by adding a base64 decode) - this requires <code>langdetect</code> to do some basic result parsing. It&#8217;s not great, but it ended up getting the job&nbsp;done! </p>
<p>The methodology behind the development of this was to initially decode the message as a <code>base64-&gt;hex-&gt;xor(single byte)</code>, but I needed to add a <code>.decode('hex')</code> while developing to get a readable result. Most of the results were garbled text, but a small amount looked like base64, which is where the second set of <code>b64decode</code> comes&nbsp;from. </p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">base64</span><span class="o">,</span> <span class="nn">binascii</span><span class="o">,</span> <span class="nn">string</span>
<span class="kn">from</span> <span class="nn">textwrap</span> <span class="kn">import</span> <span class="n">wrap</span>
<span class="kn">from</span> <span class="nn">langdetect</span> <span class="kn">import</span> <span class="n">detect</span>
<span class="k">def</span> <span class="nf">try_base64</span> <span class="p">(</span><span class="nb">input</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="n">result</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">pass</span> 
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">True</span>

<span class="c1"># take our input string and convert it to hexadecimal </span>
<span class="n">input_string</span> <span class="o">=</span> <span class="s1">&#39;jrKJt72MnauFjJ3uvJydi4bt5u+7l7S3lpmzqbuMnaW97afthYiOuLuYt7OWl53uurGvrIWMmriN7ee4u5jnuLyys6m7nOqvvYyd772mnbW8som3u5iKuIaI67iGiJG1veyJqruc67iJmLezvbadrr3ts6qWnJG2veyVsZCyt6m7mKevvbKKqoayp6+9tuqxhaadt72yjri7l7OohYyet4aHie++nJ2qvO2vsoW0jbCLtKeQke67rJCKlqiJmo6mkIeds5CKjZC7ma+Ou++JkYqO4uI=&#39;</span>
<span class="n">string_hex</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">input_string</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">)</span>

<span class="n">hex_range</span> <span class="o">=</span> <span class="p">[</span><span class="nb">hex</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">)]</span>

<span class="n">result_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">string_split</span> <span class="o">=</span> <span class="n">wrap</span><span class="p">(</span><span class="n">string_hex</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">hex_range</span><span class="p">:</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
    <span class="n">temp_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">string_split</span><span class="p">:</span>
        <span class="c1"># xor and add to list as hex</span>
        <span class="c1"># print(&#39;xoring {} and {}&#39;.format(int(i, 16), int(value,16)))</span>
        <span class="n">xor_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span> <span class="o">^</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
        <span class="c1"># print(&#39;appending {}&#39;.format(hex(xor_value)))</span>
        <span class="n">temp_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">xor_value</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

    <span class="n">new_result</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_values</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">temp_values</span><span class="p">)]))</span>
    <span class="c1"># print(&#39;appending {}&#39;.format(new_result))</span>
    <span class="n">result_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_result</span><span class="p">)</span>

<span class="n">valid_results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">printable</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">printable</span><span class="p">)</span>
<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">result_list</span><span class="p">:</span>
    <span class="c1"># convert to base64 and see if its decodeable</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="n">b64string</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;hex&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;base64&#39;</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">if</span><span class="p">(</span><span class="n">try_base64</span><span class="p">(</span><span class="n">b64string</span><span class="p">)):</span> 
        <span class="c1"># try to decode the string and check if it&#39;s valid </span>
        <span class="n">test_string</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">b64string</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="n">try_base64</span><span class="p">(</span><span class="n">test_string</span><span class="p">)):</span>
            <span class="n">test_string</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">test_string</span><span class="p">)</span>

        <span class="c1"># check language</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">test_lang</span> <span class="o">=</span> <span class="n">detect</span><span class="p">(</span><span class="n">test_string</span><span class="p">)</span>
            <span class="c1"># should we assume that the answer has a space as well?</span>
            <span class="c1"># using langdetect to check for a string which matches &#39;en&#39;, and has a space</span>
            <span class="c1"># we also do a simple comparison to throw out all non-printable characters, and check input-&gt;output length</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">test_lang</span> <span class="o">==</span> <span class="s1">&#39;en&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39; &#39;</span> <span class="ow">in</span> <span class="n">test_string</span><span class="p">)</span> <span class="p">):</span>
                <span class="c1"># looks ok, try to remove non printable chars and check if its the same </span>
                <span class="n">printable_chars</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">printable</span><span class="p">,</span> <span class="n">test_string</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="s1">&#39;processing: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">test_string</span><span class="p">))</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">printable_chars</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_string</span><span class="p">)):</span>
                    <span class="c1"># strings match </span>
                    <span class="n">valid_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_string</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span> 
            <span class="k">pass</span>

<span class="n">valid_results</span>
</pre></div>


<p>running this&nbsp;file: </p>
<div class="codehilite"><pre><span></span>user@box:~/tc_spock_chat$ python testfile.py 
processing: <span class="m">7</span>
/            <span class="m">05</span>$&lt;<span class="m">5</span><span class="nv">$W</span>%<span class="nv">$2</span>?T_V.
<span class="m">5</span><span class="nv">$TT</span>&lt;<span class="m">17</span>!
/.$&lt;<span class="m">5</span><span class="c1">#4T^!^</span>

%S5<span class="nv">$V</span>$

      <span class="m">0</span>!3?1R?1<span class="o">(</span>
               U0%R0!
<span class="nv">$T</span>
/%<span class="o">(</span>U<span class="o">)</span>
     !
      <span class="m">3</span>?
        &lt;$
          <span class="m">7</span>.
&lt;<span class="m">5</span><span class="s1">&#39;?&gt;0V%$T</span>
<span class="s1">)(W)3/0#7)&gt;$</span>
<span class="s1">)34) 7V0(37[[</span>
<span class="s1">processing: B~E{q@QgI@Q&quot;pPQGJ!*#w[x{ZUew@Qiq!k!IDBtwT{Z[Q&quot;v}c`I@VtA!+twT+tp~ewP&amp;cq@Q#qjQyp~E{wTFtJD&#39;</span>tJD<span class="o">]</span>yq EfwP<span class="err">&#39;</span>tET<span class="o">{</span>qzQbq!fZP<span class="o">]</span>zq Y<span class="o">}</span><span class="se">\~</span><span class="o">{</span>ewTkcq~FfJ~kcqz<span class="p">&amp;</span><span class="o">}</span>IjQ<span class="o">{</span>q~Btw<span class="o">[</span>dI@R<span class="o">{</span>JKE#rPQfp!c~IxA<span class="p">|</span>Gxk<span class="se">\]</span><span class="s2">&quot;w`\FZdEVBj\KQ\FA\wUcBw#E]FB..</span>
<span class="s2">processing: @|GysBSeKBS rRSEH#(!uYzyXW}guBSks#i#KF@vuVy}XYS tabKBTvC#)vuV)vr|}guR</span><span class="nv">$asBS</span><span class="s2">!shS{r|GyuVDvHF%vHF_{s&quot;</span>GduR%vGVy<span class="o">}</span>sxS<span class="sb">`</span>s#<span class="o">}</span>dXR_xs<span class="s2">&quot;[^|yguVias|DdH|iasx</span><span class="nv">$KhSys</span><span class="s2">|@vuY}fKBPyHIG!pRSdr#a|KzC~Ezi^_ ub^DXfGT@h^IS}^DC^uWa@u!G_D@,,</span>
<span class="s2">processing: A}FxrCRdJCR!sSRDI&quot;</span><span class="o">)</span> tX<span class="o">{</span>xYV<span class="p">|</span>ftCRjr<span class="s2">&quot;h&quot;</span>JGAwtWx<span class="p">|</span>YXR!u~<span class="sb">`</span>cJCUwB<span class="s2">&quot;(wtW(ws}|ftS%`rCR riRzs}FxtWEwIG</span><span class="nv">$wIG</span><span class="s2">^zr#FetS</span><span class="nv">$wFWx</span><span class="s2">|ryRar&quot;</span><span class="p">|</span>eYS^yr#Z~_<span class="o">}</span>xftWh<span class="sb">`</span>r<span class="o">}</span>EeI<span class="o">}</span>h<span class="sb">`</span>ry%~JiRxr<span class="o">}</span>AwtX<span class="p">|</span>gJCQxIHF qSRes<span class="s2">&quot;`}J{BD{h_^!tc_EYgFUAi_HR|_EB_tV`At F^EA--</span>
<span class="s2">processing: Beam me up Scotty! You solved the puzzle! Go to riot.im to create an account. Then join #borg:hotline.blin.gg and type !auth nsjffDhNLN7Wl9B0TD29pe9DNtZPwEMQ</span>
</pre></div>


<p>I had some erroneous results in the output, but I was able to get the correct message in the end. I&#8217;m currently working through the Cryptopals challenges, and I would highly recommend them - they build on top of each other and are very good for learning (for me at least!). Thank you for reading, and thanks to the ThugCrowd community for making this awesome&nbsp;challenge! </p>
	</div>

	<div id="related-articles">
		<a href="/2019/07/thugcrowd-elf-chat-challenge/" id="prev-neighbour">ThugCrowd ELF Chat Challenge &raquo;</a>
	</div>

			<hr>
		</article>

		<footer>
			<p>Powered by <a href="http://getpelican.com">Pelican</a>, <a href="https://github.com/iKevinY/pneumatic">Pneumatic</a> and <a href="http://pages.github.com">GitHub Pages</a>.</p>
		</footer>
	</div>


</body>
</html>