<!DOCTYPE html>
<html lang="en">
<head>
	<!-- Basic Metas -->
	<meta charset="utf-8">
	<title>ThugCrowd ELF Chat Challenge | shambo.li</title>
	<meta name="description" content="Thugcrowd Matrix ELF Chat Challenge Link, Mirror: As with most challenges which appear to be base64 encoded, I think it’s always good to try to decode them first to see if there is anything worthwhile (a message which is encoded) or …">
	<meta name="author" content="n">
	<link rel="author" href=""/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<!-- Twitter Cards and Open Graph -->
	<meta name="twitter:card" content="summary">
	<meta name="twitter:creator" content="@shamb0li">
	<meta name="twitter:domain" content="shambo.li">
	<meta name="twitter:site" content="@shamb0li">
	<meta property="og:title" content="ThugCrowd ELF Chat Challenge">
	<meta property="og:description" content="Thugcrowd Matrix ELF Chat Challenge Link, Mirror: As with most challenges which appear to be base64 encoded, I think it’s always good to try to decode them first to see if there is anything worthwhile (a message which is encoded) or …">
	<meta property="og:image" content="../../../images/icons/avatar.png">
	<meta property="og:type" content="article">
	<meta property="og:url" content="../../../2019/07/thugcrowd-elf-chat-challenge/">

	<!-- Stylesheets and Web Fonts -->
	<link href="/theme/style.min.css?2af86252" rel="stylesheet">
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-1.x-git.min.js"></script>
    <script src="/includes/js/lightbox.js"></script>
    <link href="/includes/css/lightbox.css" rel="stylesheet" />

	<!-- Favicons -->
	<link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="57x57" href="/images/icons/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/images/icons/apple-touch-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/images/icons/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/images/icons/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/images/icons/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/images/icons/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/images/icons/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/images/icons/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/images/icons/apple-touch-icon-180x180.png">

	<link rel="icon" type="image/png" href="/images/icons/favicon-16x16.png" sizes="16x16">
	<link rel="icon" type="image/png" href="/images/icons/favicon-32x32.png" sizes="32x32">
	<link rel="icon" type="image/png" href="/images/icons/favicon-96x96.png" sizes="96x96">
	<link rel="icon" type="image/png" href="/images/icons/favicon-160x160.png" sizes="160x160">
	<link rel="icon" type="image/png" href="/images/icons/favicon-196x196.png" sizes="196x196">

	<meta name="theme-color" content="">

	<meta name="msapplication-TileColor" content="">
	<meta name="msapplication-TileImage" content="/images/icons/mstile-144x144.png">
	<meta name="msapplication-square70x70logo" content="/images/icons/mstile-small.png">
	<meta name="msapplication-square150x150logo" content="/images/icons/mstile-medium.png">
	<meta name="msapplication-wide310x150logo" content="/images/icons/mstile-wide.png">
	<meta name="msapplication-square310x310logo" content="/images/icons/mstile-large.png">

	<!--[if lt IE 9]>
	<script src="/theme/js/html5shiv.min.js"></script>
	<script src="/theme/js/respond.min.js"></script>
	<![endif]-->
</head>

<body>
	<div class="container">
		<aside>
			<a href="/"><img id="avatar" alt="Site Avatar" src="/images/icons/avatar.png"></a>
			<div id="name"><a href="/">shambo.li</a></div>
			<div id="bio">just a person who does some things online<hr>
occasionally posts writeups, occasionally participates in ctfs, occasionally plays video games
</div>

			<div id="sidebar-links">
				<a href="/about-me/">About</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="/archive/">Archive</a>
			</div>

			<div id="social">
				<a href="mailto:n@shambo.li" title="send me an email" class="icon fa fa-envelope-o"></a>
				<a href="http://twitter.com/shamb0li" title="follow me on twitter" class="icon fa fa-twitter"></a>
				<a href="http://github.com/shamboli" title="shamboli github" class="icon fa fa-github"></a>
			</div>

			<hr id="sidebar-divider">
		</aside>

		<article>
	<h1 class="title"><a href="/2019/07/thugcrowd-elf-chat-challenge/" title="Permalink to ThugCrowd ELF Chat Challenge">ThugCrowd <span class="caps">ELF</span> Chat&nbsp;Challenge</a></h1>
	<time class="date" datetime="2019-07-27 22:00:00-05:00">Sat 27 July 2019</time>
	<div class="content">
		<h2><a href="https://twitter.com/thugcrowd/status/1153811494838030338">Thugcrowd Matrix <span class="caps">ELF</span> Chat Challenge Link</a>, <a href="http://archive.is/LFPCc">Mirror</a>:</h2>
<p>As with most challenges which appear to be base64 encoded, I think it&#8217;s always good to try to decode them first to see if there is anything worthwhile (a message which is encoded) or if it has binary characters. This just gives us a direction to head&nbsp;in.</p>
<p>Standard base64 decoders online don&#8217;t seem to like the format of this challenge, so we head to a decoder that can handle different types of characters more&nbsp;easily.</p>
<div class="codehilite"><pre><span></span>user@box:~$ base64 -d <span class="o">&lt;&lt;&lt;</span> f0VMRki7TyxCbTpkfj7rPAIAPgABAAAABAAAAAEAAAAcAAAAAAAAAAAAAAAAAAAAAQAAAEAAOAABAAIABDwPBQAAAAAEPA8FAAAAAFNIuytFKS0/RC4uU0i7L1gyREQjUjdTSLtSQ2hbY3UvblNIuyxdTi8zYldHU0i7ckFCNjgwJkVTSLs4b0pFXSs8dFNIu0RDMERFIDx+U0gx/+ud
ELFH�O,Bm:d~&gt;�&lt;&gt;@8<span class="s">&lt;&lt;SH�+E)-?D..SH</span>�/X2DD#R7SH�RCh<span class="o">[</span>cu/nSH�,<span class="o">]</span>N/3bWGSH�rAB680<span class="p">&amp;</span>ESH�8oJE<span class="o">]</span>+&lt;tSH�DC0DE &lt;~SH1��p
</pre></div>


<p>This looks like something we would want to make into a binary file, due to the first few characters being <code>ELFH</code>.</p>
<p>Another way to do this without utilizing bash would be to convert the base64 directly to hex online, and try to make a binary instead. I&#8217;m a fan of <a href="https://cryptii.com">Cryptii</a> for quick conversions:
<a href="/includes/static/thugcrowd_elf/2-cryptii-1.jpg" data-lightbox="2-cryptii-1" data-title="cryptii pt 1">
    <img src="/includes/thumbs/thugcrowd_elf/2-cryptii-1.jpg" title="" />
</a>
<a href="/includes/static/thugcrowd_elf/3-cryptii-2.jpg" data-lightbox="3-cryptii-2" data-title="cryptii pt 2">
    <img src="/includes/thumbs/thugcrowd_elf/3-cryptii-2.jpg" title="" />
</a></p>
<p>Pasting this into a hex editor (Bless or HxD are my choices), we see the same thing we saw in bash:
<a href="/includes/static/thugcrowd_elf/4-hxd.jpg" data-lightbox="4-hxd.jpg" data-title="4-hxd.jpg">
    <img src="/includes/thumbs/thugcrowd_elf/4-hxd.jpg" title="message displayed in hex" />
</a></p>
<p>To make the determination of what type of file it is without having to rely on guesswork as much, we can use a utility called <a href="https://github.com/ReFirmLabs/binwalk">Binwalk</a> to try to get a better idea of what we&#8217;re working with. We need to make a binary from this resultant hex code - we can do this by saving the hex in your hex editor of choice, or you can write it to a file using the <code>base64 -d</code> command as shown above, with some&nbsp;additions: </p>
<div class="codehilite"><pre><span></span>base64 -d <span class="o">&lt;&lt;&lt;</span> f0VMRki7TyxCbTpkfj7rPAIAPgABAAAABAAAAAEAAAAcAAAAAAAAAAAAAAAAAAAAAQAAAEAAOAABAAIABDwPBQAAAAAEPA8FAAAAAFNIuytFKS0/RC4uU0i7L1gyREQjUjdTSLtSQ2hbY3UvblNIuyxdTi8zYldHU0i7ckFCNjgwJkVTSLs4b0pFXSs8dFNIu0RDMERFIDx+U0gx/+ud &gt; ~/challenge_bin
</pre></div>


<p>With this file, we can run binwalk with no arguments other than the&nbsp;file:</p>
<div class="codehilite"><pre><span></span>user@box:~$ binwalk challenge_bin

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
</pre></div>


<p>This it doesn&#8217;t look like we are going to get anywhere with binwalk here at least. There are a couple of other ways to learn more information about files, the first one is using the aptly named <code>file</code> command:</p>
<div class="codehilite"><pre><span></span>user@box:~$ file challenge_bin 
challenge_bin: ELF, unknown class <span class="m">72</span>
</pre></div>


<p>From this we figure out what we already knew, which is that it&#8217;s in <span class="caps">ELF</span> format, but not much more. We can verify this by using a <a href="https://www.garykessler.net/library/file_sigs.html">common file signature table</a>, to search for the first few bytes, in this case, <code>7F 45 4C 46</code>. On Gary&#8217;s website, we get this result:
<a href="/includes/static/thugcrowd_elf/5-fst.jpg" data-lightbox="5-fst.jpg" data-title="gary kesslers awesome file signature table">
    <img src="/includes/thumbs/thugcrowd_elf/5-fst.jpg" title="" />
</a></p>
<p>We can pretty much assume this is a binary <span class="caps">ELF</span> without a doubt. Another <code>obvious</code> clue was in the ThugCrowd follow up tweet, stating: <a href="https://twitter.com/thugcrowd/status/1153811747045691392">Yes, it&#8217;s a binary. No, binary analysis tools will not work here.</a>, but it&#8217;s always good to be&nbsp;sure.</p>
<p>We need to modify the binary to be executable, using <code>chmod +x ~/challenge_bin</code>, and we can execute it with <code>~/challenge_bin</code>. Unfortunately, when we do this we get no result, so from here, I&#8217;ll usually try to feed the binary some input to see if I can get a different result. Again, unfortunately, passing the file any arguments (<code>-h, -i, --input, etc</code>) results in the same outcome, which is that there is no&nbsp;result. </p>
<p>One of the good things about this file is that it&#8217;s very small, so it&#8217;s easy to run and parse the output from the Linux <code>strings</code> command on the&nbsp;binary:</p>
<div class="codehilite"><pre><span></span>user@box:~$ strings challenge_bin 
ELFH
O,Bm:d~&gt;
+E<span class="o">)</span>-?D..SH
/X2DD#R7SH
RCh<span class="o">[</span>cu/nSH
,<span class="o">]</span>N/3bWGSH
rAB680<span class="p">&amp;</span>ESH
8oJE<span class="o">]</span>+&lt;tSH
DC0DE &lt;~SH1
</pre></div>


<p>This output is very interesting, and more reminiscent of a code than something we should be executing - the main part that should point us in that direction is the <code>SH</code> termination on every line, and the <code>DC0DE</code> at the very end. If we look at the string following <code>DC0De</code>, <code>&lt;~SH1</code>, along with the first non-<span class="caps">ELFH</span> line, <code>O,Bm:d~&gt;</code>, this is somewhat of a clue, although not quite an obvious&nbsp;one. </p>
<p>A few weeks prior to this, <a href="https://twitter.com/thugcrowd/status/1149142932487905281">ThugCrowd tweeted</a>/<a href="http://archive.is/ZjnCE">mirror</a> an encrypted message forwarded from the DollarVPNClub Tactical Datacenter Ops Commander, directed at the current <span class="caps">VPN</span> regime: <code>&lt;~6=h9&lt;F`M%9&lt;,WmIEbTE,+B`W*EZe/$@;L%"DIkF~&gt;</code>. This message format was unfamiliar to me at the time, but a Google search guess gave me a pretty good idea of how to decode&nbsp;it:</p>
<p><a href="/includes/static/thugcrowd_elf/6-character-search.jpg" data-lightbox="6-character-search.jpg" data-title="character search">
    <img src="/includes/thumbs/thugcrowd_elf/6-character-search.jpg" title="" />
</a></p>
<p>Being able to identify the ascii85 encoding scheme leads us back to the original problem, since it certainly seems possible that this message could be encoded as such. Doing some trial and error with ordering the output string properly doesn&#8217;t really give us anything, but there are some assumptions that we can make with this&nbsp;message. </p>
<ul>
<li>We can probably exclude the <code>ELFH</code> header, as this was probably added to point the solver in the wrong&nbsp;direction.</li>
<li>Due to the fact that <code>SH</code> appears on every line but the decode fails when including it, we can probably remove the string from each&nbsp;line. </li>
<li><code>DC0DE</code> was probably added to point the solver in the right direction, and is not actually part of the&nbsp;message. </li>
</ul>
<p>That leaves us with a message like&nbsp;this: </p>
<div class="codehilite"><pre><span></span>O,Bm:d~&gt;
+E<span class="o">)</span>-?D..
/X2DD#R7
RCh<span class="o">[</span>cu/n
,<span class="o">]</span>N/3bWG
rAB680<span class="p">&amp;</span>E
8oJE<span class="o">]</span>+&lt;t
&lt;~1
</pre></div>


<p>We know from the original tactical-encrypted <span class="caps">VPN</span> message that ascii85 encoded strings aren&#8217;t decoded with the <code>&lt;~ ~&gt;</code> characters wrapping the string (at least, not on Cryptii), so we can remove these as well to get something like&nbsp;this: </p>
<div class="codehilite"><pre><span></span>O,Bm:d
+E<span class="o">)</span>-?D..
/X2DD#R7
RCh<span class="o">[</span>cu/n
,<span class="o">]</span>N/3bWG
rAB680<span class="p">&amp;</span>E
8oJE<span class="o">]</span>+&lt;t
<span class="m">1</span>
</pre></div>


<p>Pasting this into Cryptii gives us an encoding error: <code>Unexpected continuation byte at 0x0</code>. Deleting the first character doesn&#8217;t help, and trying to make the decoder happy by removing more characters doesn&#8217;t help either. The clue that pointed me in the right direction was the bottom, unstripped section, and the top unstripped&nbsp;sections: </p>
<div class="codehilite"><pre><span></span>O,Bm:d~&gt;
---snip---
DC0DE &lt;~SH1
</pre></div>


<p>The opening and closing terminations on this message are the key - wrapping the message around bottom to top would leave us&nbsp;with: </p>
<div class="codehilite"><pre><span></span>&lt;~1O,Bm:d~&gt;
</pre></div>


<p>Which is a very short message, leaving most of the text unused. As you might expect, this gives us nothing, but going from bottom to top through the message, reversing it, gives us&nbsp;this: </p>
<div class="codehilite"><pre><span></span><span class="m">1</span>
8oJE<span class="o">]</span>+&lt;t
rAB680<span class="p">&amp;</span>E
,<span class="o">]</span>N/3bWG
RCh<span class="o">[</span>cu/n
/X2DD#R7
+E<span class="o">)</span>-?D..
O,Bm:d
</pre></div>


<p>Pasting this into Cryptii gives us a continuation error, but luckily this time removing the invalid character gives us the answer, which comes from this ascii85 encoded&nbsp;message:</p>
<div class="codehilite"><pre><span></span>8oJE<span class="o">]</span>+&lt;t
rAB680<span class="p">&amp;</span>E
,<span class="o">]</span>N/3bWG
RCh<span class="o">[</span>cu/n
/X2DD#R7
+E<span class="o">)</span>-?D..
O,Bm:d
</pre></div>


<p><a href="/includes/static/thugcrowd_elf/7-cryptii-error.jpg" data-lightbox="7-cryptii-error.jpg" data-title="cryptii error">
    <img src="/includes/thumbs/thugcrowd_elf/7-cryptii-error.jpg" title="" />
</a>
<a href="/includes/static/thugcrowd_elf/8-answer.jpg" data-lightbox="8-answer.jpg" data-title="challenge result">
    <img src="/includes/thumbs/thugcrowd_elf/8-answer.jpg" title="8-answer.jpg" />
</a></p>
<p>This writeup is sponsored by and dedicated to DollarVPNClub, without their help and faithful network of cryptographic enhancements I would never have been able to complete this challenge. <code>#FREEDVC</code>
<a href="/includes/static/thugcrowd_elf/dvc.jpg" data-lightbox="8-answer.jpg" data-title="FREEDVC">
    <img src="/includes/thumbs/thugcrowd_elf/dvc.jpg" title="dvc.jpg" />
</a></p>
	</div>

	<div id="related-articles">
		<a href="/2018/08/thugcrowd-defcon-badge-challenge/" id="prev-neighbour">ThugCrowd DEFCON Badge Challenge &raquo;</a>
	</div>

			<hr>
		</article>

		<footer>
			<p>Powered by <a href="http://getpelican.com">Pelican</a>, <a href="https://github.com/iKevinY/pneumatic">Pneumatic</a> and <a href="http://pages.github.com">GitHub Pages</a>.</p>
		</footer>
	</div>


</body>
</html>